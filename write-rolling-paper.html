<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rolling</title>
    <!-- <link rel="stylesheet" href="/css/WriteRolling.css"> -->
    <script src="https://code.iconify.design/iconify-icon/1.0.7/iconify-icon.min.js"></script>
    <link rel="stylesheet" href="./css/write-rolling-paper.css">

</head>

<body>
    <div id="wrap">
        <header>
            <span class="rolling_title" onclick="goHome()">Rolling</span>
            <div class="hamberger_menu"><iconify-icon icon="material-symbols:menu" width="25"
                    height="24"></iconify-icon></div>
        </header>
        <main>
            <div class="top_box">
                <div class="rec_box"></div>
                <button id="sharebtn"><iconify-icon icon="ph:share-fat-fill" width="25"
                        height="23"></iconify-icon></button>
            </div>
            <div class="middle_box"></div>
            <div class="bottom_box">
                <div class="edit_btn"><iconify-icon icon="mdi:pencil-add" width="30" height="28"></iconify-icon></div>
                <div class="emoji_btn"><iconify-icon icon="mdi:emoji" width="30" height="29"></iconify-icon></div>
            </div>

        </main>
        <button class="send_btn">전송하기</button>
    </div>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"
        integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <script>
        let receiver = "";

        const url = new URL(window.location.href);
        console.log(url);

        // URLSearchParams 객체
        const urlParams = url.searchParams;

        // URLSearchParams.get()
        let id = urlParams.get('id');

        // 2. ajax 함수 이용해서 api 호출, success 응답 호출 해보기
        $.support.cors = true;
        $.ajax({
            type: 'get',           // 타입 (get, post, put 등등)
            url: `http://localhost:3000/api/rollingpapers/${id}`,           // 요청할 서버url
            async: true,            // 비동기화 여부 (default : true)
            dataType: 'json',       // 데이터 타입 (html, xml, json, text 등등)
            data: {},
            contentType: "application/json",
            success: function (result) { // 결과 성공 콜백함수
                setPaperHtml(result.result.receiver);// 받는 사람 띄우기
            }
        });

        function setPaperHtml(receiver) {
            $(".rec_box").append(getPaperHtml(receiver));// html - 덮어씌우기, append - 추가하기
        }

        function getPaperHtml(receiver) {
            return `<div class="rec_tit">To.</div>
                    <div id="recipient_input">${receiver}</div>`;
        }
    </script>
    <script src="./js/script.js"></script>
    <script src="./js/write-rolling-paper.js"></script>
</body>

</html>