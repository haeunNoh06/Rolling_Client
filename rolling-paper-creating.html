<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="./css/style.css">
    <link rel="stylesheet" href="./css/rolling-paper-creating.css">
</head>

<body>
    <header>
        <div class="title" onclick="goHome()">Rolling</div>
        <img id="menu-outline" src="img/menu-outline.svg" alt="메뉴바">
    </header>
    <div class="wrapper">


        <div class="container">
            <div class="title">롤링페이퍼를 만들어요</div>
            <div class="input-paper-title">
                <label for="paper-title">제목</label><br>
                <input type="text" id="paper-title" placeholder="롤링페이퍼의 제목을 입력하세요">
            </div>
            <div class="input-receiver">
                <label for="receiver">받을 대상</label><br>
                <input type="text" id="receiver" placeholder="롤링페이퍼를 받을 대상의 이름을 입력하세요">
            </div>
            <button onclick="create()">롤링페이퍼 생성하기</button>
        </div>

    </div>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"
        integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <script>
        let paper_title;
        let receiver;
        let id;

        function create() {
            console.log('onclick!');
            var paper_title = $("#paper-title").val();
            var receiver = $("#receiver").val();

            let param = {
                "title": paper_title,
                "receiver": receiver
            };
            console.log(param);

             // 2. ajax 함수 이용해서 api 호출, success 응답 호출 해보기
            $.ajax({
                type: 'post',           // 타입 (get, post, put 등등)
                url: `http://localhost:3000/api/rollingpapers`,           // 요청할 서버url
                async: true,            // 비동기화 여부 (default : true)
                dataType: 'json',       // 데이터 타입 (html, xml, json, text 등등)
                data: JSON.stringify(param),
                contentType: "application/json",
                success: function (data) { // 결과 성공 콜백함수
                    console.log(data.rollingpaperId);
                    id = data.rollingpaperId;
                    location.href = `./WriteRolling.html?id=${id}`;
                }
            });
        }
       
    </script>
    <script src="./js/script.js"></script>
</body>

</html>